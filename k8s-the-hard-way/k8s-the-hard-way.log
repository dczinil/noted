Bringing machine 'master-1' up with 'virtualbox' provider...
Bringing machine 'master-2' up with 'virtualbox' provider...
Bringing machine 'loadbalancer' up with 'virtualbox' provider...
Bringing machine 'worker-1' up with 'virtualbox' provider...
Bringing machine 'worker-2' up with 'virtualbox' provider...
==> master-1: Box 'ubuntu/jammy64' could not be found. Attempting to find and install...
    master-1: Box Provider: virtualbox
    master-1: Box Version: >= 0
==> master-1: Loading metadata for box 'ubuntu/jammy64'
    master-1: URL: https://vagrantcloud.com/ubuntu/jammy64
==> master-1: Adding box 'ubuntu/jammy64' (v20230110.0.0) for provider: virtualbox
    master-1: Downloading: https://vagrantcloud.com/ubuntu/boxes/jammy64/versions/20230110.0.0/providers/virtualbox.box
Download redirected to host: cloud-images.ubuntu.com
==> master-1: Successfully added box 'ubuntu/jammy64' (v20230110.0.0) for 'virtualbox'!
==> master-1: Importing base box 'ubuntu/jammy64'...
==> master-1: Matching MAC address for NAT networking...
==> master-1: Setting the name of the VM: kubernetes-ha-master-1
Vagrant is currently configured to create VirtualBox synced folders with
the  option enabled. If the Vagrant
guest is not trusted, you may want to disable this option. For more
information on this option, please refer to the VirtualBox manual:

  https://www.virtualbox.org/manual/ch04.html#sharedfolders

This option can be disabled globally with an environment variable:

  VAGRANT_DISABLE_VBOXSYMLINKCREATE=1

or on a per folder basis within the Vagrantfile:

  config.vm.synced_folder '/host/path', '/guest/path', SharedFoldersEnableSymlinksCreate: false
==> master-1: Clearing any previously set network interfaces...
==> master-1: Preparing network interfaces based on configuration...
    master-1: Adapter 1: nat
    master-1: Adapter 2: hostonly
==> master-1: Forwarding ports...
    master-1: 22 (guest) => 2711 (host) (adapter 1)
    master-1: 22 (guest) => 2222 (host) (adapter 1)
==> master-1: Running 'pre-boot' VM customizations...
==> master-1: Booting VM...
==> master-1: Waiting for machine to boot. This may take a few minutes...
    master-1: SSH address: 127.0.0.1:2222
    master-1: SSH username: vagrant
    master-1: SSH auth method: private key
    master-1: Warning: Connection reset. Retrying...
    master-1: 
    master-1: Vagrant insecure key detected. Vagrant will automatically replace
    master-1: this with a newly generated keypair for better security.
    master-1: 
    master-1: Inserting generated public key within guest...
    master-1: Removing insecure key from the guest if it's present...
    master-1: Key inserted! Disconnecting and reconnecting using new SSH key...
==> master-1: Machine booted and ready!
==> master-1: Checking for guest additions in VM...
    master-1: The guest additions on this VM do not match the installed version of
    master-1: VirtualBox! In most cases this is fine, but in rare cases it can
    master-1: prevent things such as shared folders from working properly. If you see
    master-1: shared folder errors, please make sure the guest additions within the
    master-1: virtual machine match the version of VirtualBox you have installed on
    master-1: your host and reload your VM.
    master-1: 
    master-1: Guest Additions Version: 6.0.0 r127566
    master-1: VirtualBox Version: 7.0
==> master-1: Setting hostname...
==> master-1: Configuring and enabling network interfaces...
==> master-1: Mounting shared folders...
    master-1: /vagrant => /home/sysadmin/pro/k8s-the-hard-way/vagrant
==> master-1: Running provisioner: setup-kernel (shell)...
    master-1: Running: /tmp/vagrant-shell20230206-37580-1rkxd0r.sh
    master-1: + sed -i 's/GRUB_CMDLINE_LINUX_DEFAULT="/GRUB_CMDLINE_LINUX_DEFAULT="systemd.unified_cgroup_hierarchy=0 ipv6.disable=1 /' /etc/default/grub
    master-1: + update-grub
    master-1: Sourcing file /etc/default/grub.d/50-cloudimg-settings.cfg'
    master-1: Sourcing file /etc/default/grub'
    master-2: Sourcing file /etc/default/grub.d/init-select.cfg'
    master-2: Generating grub configuration file ...
    master-2: Found linux image: /boot/vmlinuz-5.15.0-57-generic
    master-2: Found initrd image: /boot/initrd.img-5.15.0-57-generic
    master-2: Warning: os-prober will not be executed to detect other bootable partitions.
    master-2: Systems on them will not be added to the GRUB boot configuration.
    master-2: Check GRUB_DISABLE_OS_PROBER documentation entry.
    master-2: done
    master-2: + echo br_netfilter
    master-2: + cat
==> master-2: Running provisioner: shell...
    master-2: Running: inline script
    master-2: Rebooting
==> master-2: Waiting for machine to reboot...
==> master-2: Running provisioner: setup-hosts (shell)...
    master-2: Running: /tmp/vagrant-shell20230206-37580-3bbjpy.sh
    master-2: + IFNAME=enp0s8
    master-2: + THISHOST=master-2
    master-2: ++ cut -d/ -f1
    master-2: ++ grep inet
    master-2: ++ awk '{print }'
    master-2: ++ head -1
    master-2: ++ ip -4 addr show enp0s8
    master-2: + ADDRESS=192.168.56.12
    master-2: ++ echo 192.168.56.12
    master-2: ++ awk 'BEGIN {FS="."} ; { printf("%s.%s.%s", , , ) }'
    master-2: + NETWORK=192.168.56
    master-2: + sed -e 's/^.*master-2.*/192.168.56.12 master-2 master-2.local/' -i /etc/hosts
    master-2: + sed -e '/^.*ubuntu-jammy.*/d' -i /etc/hosts
    master-2: + sed -e '/^.*master-2.*/d' -i /etc/hosts
    master-2: + cat
==> master-2: Running provisioner: setup-dns (shell)...
    master-2: Running: /tmp/vagrant-shell20230206-37580-5ae4jz.sh
==> master-2: Running provisioner: shell...
    master-2: Running: inline script
==> loadbalancer: Box 'ubuntu/jammy64' could not be found. Attempting to find and install...
    loadbalancer: Box Provider: virtualbox
    loadbalancer: Box Version: >= 0
==> loadbalancer: Loading metadata for box 'ubuntu/jammy64'
    loadbalancer: URL: https://vagrantcloud.com/ubuntu/jammy64
==> loadbalancer: Adding box 'ubuntu/jammy64' (v20230110.0.0) for provider: virtualbox
==> loadbalancer: Importing base box 'ubuntu/jammy64'...
==> loadbalancer: Matching MAC address for NAT networking...
==> loadbalancer: Setting the name of the VM: kubernetes-ha-lb
==> loadbalancer: Fixed port collision for 22 => 2222. Now on port 2201.
==> loadbalancer: Clearing any previously set network interfaces...
==> loadbalancer: Preparing network interfaces based on configuration...
    loadbalancer: Adapter 1: nat
    loadbalancer: Adapter 2: hostonly
==> loadbalancer: Forwarding ports...
    loadbalancer: 22 (guest) => 2730 (host) (adapter 1)
    loadbalancer: 22 (guest) => 2201 (host) (adapter 1)
==> loadbalancer: Running 'pre-boot' VM customizations...
==> loadbalancer: Booting VM...
==> loadbalancer: Waiting for machine to boot. This may take a few minutes...
    loadbalancer: SSH address: 127.0.0.1:2201
    loadbalancer: SSH username: vagrant
    loadbalancer: SSH auth method: private key
    loadbalancer: Warning: Connection reset. Retrying...
    loadbalancer: Warning: Remote connection disconnect. Retrying...
    loadbalancer: 
    loadbalancer: Vagrant insecure key detected. Vagrant will automatically replace
    loadbalancer: this with a newly generated keypair for better security.
    loadbalancer: 
    loadbalancer: Inserting generated public key within guest...
    loadbalancer: Removing insecure key from the guest if it's present...
    loadbalancer: Key inserted! Disconnecting and reconnecting using new SSH key...
==> loadbalancer: Machine booted and ready!
==> loadbalancer: Checking for guest additions in VM...
    loadbalancer: The guest additions on this VM do not match the installed version of
    loadbalancer: VirtualBox! In most cases this is fine, but in rare cases it can
    loadbalancer: prevent things such as shared folders from working properly. If you see
    loadbalancer: shared folder errors, please make sure the guest additions within the
    loadbalancer: virtual machine match the version of VirtualBox you have installed on
    loadbalancer: your host and reload your VM.
    loadbalancer: 
    loadbalancer: Guest Additions Version: 6.0.0 r127566
    loadbalancer: VirtualBox Version: 7.0
==> loadbalancer: Setting hostname...
==> loadbalancer: Configuring and enabling network interfaces...
==> loadbalancer: Mounting shared folders...
    loadbalancer: /vagrant => /home/sysadmin/pro/k8s-the-hard-way/vagrant
==> loadbalancer: Running provisioner: setup-hosts (shell)...
    loadbalancer: Running: /tmp/vagrant-shell20230206-37580-t5gnm5.sh
    loadbalancer: + IFNAME=enp0s8
    loadbalancer: + THISHOST=loadbalancer
    loadbalancer: ++ cut -d/ -f1
    loadbalancer: ++ awk '{print }'
    loadbalancer: ++ head -1
    loadbalancer: ++ grep inet
    loadbalancer: ++ ip -4 addr show enp0s8
    loadbalancer: + ADDRESS=192.168.56.30
    loadbalancer: ++ awk 'BEGIN {FS="."} ; { printf("%s.%s.%s", , , ) }'
    loadbalancer: ++ echo 192.168.56.30
    loadbalancer: + NETWORK=192.168.56
    loadbalancer: + sed -e 's/^.*loadbalancer.*/192.168.56.30 loadbalancer loadbalancer.local/' -i /etc/hosts
    loadbalancer: + sed -e '/^.*ubuntu-jammy.*/d' -i /etc/hosts
    loadbalancer: + sed -e '/^.*loadbalancer.*/d' -i /etc/hosts
    loadbalancer: + cat
==> loadbalancer: Running provisioner: setup-dns (shell)...
    loadbalancer: Running: /tmp/vagrant-shell20230206-37580-1poupts.sh
==> worker-1: Box 'ubuntu/jammy64' could not be found. Attempting to find and install...
    worker-1: Box Provider: virtualbox
    worker-1: Box Version: >= 0
==> worker-1: Loading metadata for box 'ubuntu/jammy64'
    worker-1: URL: https://vagrantcloud.com/ubuntu/jammy64
==> worker-1: Adding box 'ubuntu/jammy64' (v20230110.0.0) for provider: virtualbox
==> worker-1: Importing base box 'ubuntu/jammy64'...
==> worker-1: Matching MAC address for NAT networking...
==> worker-1: Setting the name of the VM: kubernetes-ha-worker-1
==> worker-1: Fixed port collision for 22 => 2222. Now on port 2202.
==> worker-1: Clearing any previously set network interfaces...
==> worker-1: Preparing network interfaces based on configuration...
    worker-1: Adapter 1: nat
    worker-1: Adapter 2: hostonly
==> worker-1: Forwarding ports...
    worker-1: 22 (guest) => 2721 (host) (adapter 1)
    worker-1: 22 (guest) => 2202 (host) (adapter 1)
==> worker-1: Running 'pre-boot' VM customizations...
==> worker-1: Booting VM...
==> worker-1: Waiting for machine to boot. This may take a few minutes...
    worker-1: SSH address: 127.0.0.1:2202
    worker-1: SSH username: vagrant
    worker-1: SSH auth method: private key
    worker-1: Warning: Connection reset. Retrying...
    worker-1: Warning: Remote connection disconnect. Retrying...
    worker-1: 
    worker-1: Vagrant insecure key detected. Vagrant will automatically replace
    worker-1: this with a newly generated keypair for better security.
    worker-1: 
    worker-1: Inserting generated public key within guest...
    worker-1: Removing insecure key from the guest if it's present...
    worker-1: Key inserted! Disconnecting and reconnecting using new SSH key...
==> worker-1: Machine booted and ready!
==> worker-1: Checking for guest additions in VM...
    worker-1: The guest additions on this VM do not match the installed version of
    worker-1: VirtualBox! In most cases this is fine, but in rare cases it can
    worker-1: prevent things such as shared folders from working properly. If you see
    worker-1: shared folder errors, please make sure the guest additions within the
    worker-1: virtual machine match the version of VirtualBox you have installed on
    worker-1: your host and reload your VM.
    worker-1: 
    worker-1: Guest Additions Version: 6.0.0 r127566
    worker-1: VirtualBox Version: 7.0
==> worker-1: Setting hostname...
==> worker-1: Configuring and enabling network interfaces...
==> worker-1: Mounting shared folders...
    worker-1: /vagrant => /home/sysadmin/pro/k8s-the-hard-way/vagrant
==> worker-1: Running provisioner: setup-kernel (shell)...
    worker-1: Running: /tmp/vagrant-shell20230206-37580-cviln5.sh
    worker-1: + sed -i 's/GRUB_CMDLINE_LINUX_DEFAULT="/GRUB_CMDLINE_LINUX_DEFAULT="systemd.unified_cgroup_hierarchy=0 ipv6.disable=1 /' /etc/default/grub
    worker-1: + update-grub
    worker-1: Sourcing file /etc/default/grub.d/50-cloudimg-settings.cfg'
    worker-1: Sourcing file /etc/default/grub'
    worker-2: Sourcing file /etc/default/grub.d/init-select.cfg'
    worker-2: Generating grub configuration file ...
    worker-2: Found linux image: /boot/vmlinuz-5.15.0-57-generic
    worker-2: Found initrd image: /boot/initrd.img-5.15.0-57-generic
    worker-2: Warning: os-prober will not be executed to detect other bootable partitions.
    worker-2: Systems on them will not be added to the GRUB boot configuration.
    worker-2: Check GRUB_DISABLE_OS_PROBER documentation entry.
    worker-2: done
    worker-2: + echo br_netfilter
    worker-2: + cat
==> worker-2: Running provisioner: shell...
    worker-2: Running: inline script
    worker-2: Rebooting
==> worker-2: Waiting for machine to reboot...
==> worker-2: Running provisioner: setup-hosts (shell)...
    worker-2: Running: /tmp/vagrant-shell20230206-37580-j6ia2o.sh
    worker-2: + IFNAME=enp0s8
    worker-2: + THISHOST=worker-2
    worker-2: ++ grep inet
    worker-2: ++ head -1
    worker-2: ++ ip -4 addr show enp0s8
    worker-2: ++ awk '{print }'
    worker-2: ++ cut -d/ -f1
    worker-2: + ADDRESS=192.168.56.22
    worker-2: ++ awk 'BEGIN {FS="."} ; { printf("%s.%s.%s", , , ) }'
    worker-2: ++ echo 192.168.56.22
    worker-2: + NETWORK=192.168.56
    worker-2: + sed -e 's/^.*worker-2.*/192.168.56.22 worker-2 worker-2.local/' -i /etc/hosts
    worker-2: + sed -e '/^.*ubuntu-jammy.*/d' -i /etc/hosts
    worker-2: + sed -e '/^.*worker-2.*/d' -i /etc/hosts
    worker-2: + cat
==> worker-2: Running provisioner: setup-dns (shell)...
    worker-2: Running: /tmp/vagrant-shell20230206-37580-177tpol.sh
==> worker-2: Running provisioner: shell...
    worker-2: Running: inline script

